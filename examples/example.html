<!doctype>
<html>
<head>
    <script type="text/javascript" src="../dist/nebPay.js"></script>
    <script type="text/javascript">
        var NebPay = require("nebpay");
        var nebPay = new NebPay();
        var serialNumber;

        function onPayClick() {
            var to = document.getElementById("to").value;
            var value = document.getElementById("value").value;
            serialNumber = nebPay.pay(to, value, {
                qrcode: {
                    showQRCode: true
                },
                goods: {
                    name: "test",
                    desc: "test goods"
                }
            });
            setTimeout(() => {
                onRefleshClick();
            }, 1000);
        }

        function onNrc20PayClick() {
            var to = document.getElementById("nrc20to").value;
            var value = document.getElementById("nrc20value").value;
            serialNumber = nebPay.nrc20pay("NRC", to, value, {
                qrcode: {
                    showQRCode: true
                },
                goods: {
                    name: "test",
                    desc: "test goods"
                },
                nrc20: {
                    contractAddress: "",
                    name: "demoToken",
                    symbol: "NRC",
                    decimals: 18
                }
            });
            setTimeout(() => {
                onRefleshClick();
            }, 1000);
        }

        function onDeployClick() {
            var sourceType = document.getElementById("sourceType").value;
            var source = document.getElementById("source").value;
            var args = document.getElementById("deployArgs").value;
            serialNumber = nebPay.deploy(source, sourceType, args, {
                goods: {
                    name: "test",
                    desc: "test goods"
                }
            });
            setTimeout(() => {
                onRefleshClick();
            }, 1000);
        }

        function onCallClick() {
            var to = document.getElementById("callTo").value;
            var value = document.getElementById("callValue").value;
            var callFunction = document.getElementById("callFunction").value;
            var callArgs = document.getElementById("callArgs").value;
            serialNumber = nebPay.call(to, value, callFunction, callArgs, {
                qrcode: {
                    showQRCode: true
                },
                goods: {
                    name: "test",
                    desc: "test goods"
                }
            });
            setTimeout(() => {
                onRefleshClick();
            }, 1000);
        }

        function onRefleshClick() {
            nebPay.queryPayInfo(serialNumber)
            .then(function (resp) {
                document.getElementById('result').value = resp;
            })
            .catch(function (err) {
                console.log(err);
            });
        }

    </script>
    <style>
        textarea {
            width: 400px;
            height: 100px;
        }
    </style>
</head>
<body>
<h1>Demo</h1>

<div>
    <div>Normal</div>

    <div style="display: inline-block">
        <div>to:</div>
        <input type="text" id="to" placeholder="to address"/>
    </div>

    <div style="display: inline-block">
        <div>value:</div>
        <input type="text" id="value" placeholder="value"/>
    </div>
    <button type="button" onClick="onPayClick();">pay</button>
</div>

<h5></h5>

<div>
    <div>NRC20</div>

    <div style="display: inline-block">
        <div>currency:</div>
        <input type="text" id="currency" placeholder="nrc20 currency"/>
    </div>

    <div style="display: inline-block">
        <div>to:</div>
        <input type="text" id="nrc20to" placeholder="to address"/>
    </div>

    <div style="display: inline-block">
        <div>value:</div>
        <input type="text" id="nrc20value" placeholder="value"/>
    </div>
    <button type="button" onClick="onNrc20PayClick();">pay</button>
</div>

<h5></h5>

<div>
    <div>deploy</div>

    <div style="display: block">
        <div>sourceType:</div>
        <select id="sourceType">
            <option value ="js" selected = "selected">JavaScript</option>
            <option value ="ts">TypeScript</option>
        </select>
    </div>

    <div style="display: block">
        <div>source:</div>
        <textarea id="source"></textarea>
    </div>
    <div style="display: block">
        <div>args:</div>
        <input type="text" id="deployArgs" placeholder="deploy args"/>
    </div>
    <button type="button" onClick="onDeployClick();">pay</button>
</div>

<h5></h5>

<div>
    <div>Call</div>

    <div style="display: inline-block">
        <div>to:</div>
        <input type="text" id="callTo" placeholder="contract address"/>
    </div>

    <div style="display: inline-block">
        <div>value:</div>
        <input type="text" id="callValue" placeholder="value"/>
    </div>
    <div style="display: inline-block">
        <div>function:</div>
        <input type="text" id="callFunction" placeholder="function name"/>
    </div>
    <div style="display: inline-block">
        <div>args:</div>
        <input type="text" id="callArgs" placeholder="call args"/>
    </div>
    <button type="button" onClick="onCallClick();">pay</button>
</div>

<div>
    <div>pay result:</div>
    <textarea id="result" readonly="readonly"></textarea>
    <button type="button" onClick="onRefleshClick();">reflesh</button>
</div>

</body>
</html>
